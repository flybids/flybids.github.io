<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="flybid&apos;s blog">
<meta name="keywords" content="blog,博客,html,css,js,前端">
<meta property="og:type" content="website">
<meta property="og:title" content="Redo">
<meta property="og:url" content="https://flybids.github.io/index.html">
<meta property="og:site_name" content="Redo">
<meta property="og:description" content="flybid&apos;s blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Redo">
<meta name="twitter:description" content="flybid&apos;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://flybids.github.io/">





  <title>Redo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Redo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">flybid's blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2020/08/02/千面英雄——解读神话的英雄之路/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/02/千面英雄——解读神话的英雄之路/" itemprop="url">千面英雄——从神话中认识英雄之路</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-02T18:41:43+08:00">
                2020-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="书籍简介"><a href="#书籍简介" class="headerlink" title="书籍简介"></a>书籍简介</h2><h5 id="书名由来："><a href="#书名由来：" class="headerlink" title="书名由来："></a>书名由来：</h5><p>通过对大量东、西方神话的比较研究，从中总结出一个英雄的原型，这本书也因此而得名。“千面英雄”，意指神话中的英雄只有一个，那些不同时代、不同民族的神话中的英雄尽管千姿百态、各不相同，实际上乃是同一个英雄被不同的文化赋予千差万别的面貌而已。</p>
<p>两个主题：神话的统一模式（英雄之路）； 宇宙真理（如各种版本的创世神话，复活升天等）</p>
<ul>
<li>神话学大师约瑟夫·坎贝尔的奠基之作</li>
<li>整合了全球各地的童话、民间传说以及神话故事，并从中提炼出英雄之路的原型</li>
<li>寻求个人内在觉醒的“圣经”，探索自我与灵性成长的必读之作</li>
</ul>
<h2 id="英雄之路"><a href="#英雄之路" class="headerlink" title="英雄之路"></a>英雄之路</h2><h3 id="作者指的英雄是什么"><a href="#作者指的英雄是什么" class="headerlink" title="作者指的英雄是什么"></a>作者指的英雄是什么</h3><p>英雄是我们每个人内心都隐藏着的神性，只是等待着我们去认识和呈现出来。</p>
<h3 id="认识英雄之路的意义"><a href="#认识英雄之路的意义" class="headerlink" title="认识英雄之路的意义"></a>认识英雄之路的意义</h3><p>为了成为英雄，我们要像神话中的英雄一样，接受冒险的召唤，跨越阈限、获得援助、仅受考验、被传授奥义，最终回归。<strong>我们都是自己的英雄，每个人都需要理解并经历自己的英雄故事</strong>。比如：</p>
<ul>
<li><strong>启程</strong>:离开母亲子宫，来到现实世界；<strong>启蒙</strong>:家庭教育和学校教育；<strong>考验</strong>:工作不顺，生活艰辛；<strong>回归</strong>:退休回家。</li>
<li><strong>启程</strong>:离开平静生活，开始努力做事；<strong>启蒙</strong>:找到榜样，不断学习进步；<strong>考验</strong>:遇到困难和挫折；<strong>回归</strong>:完成事情，回到平静生活。</li>
</ul>
<h3 id="英雄之路的普适性"><a href="#英雄之路的普适性" class="headerlink" title="英雄之路的普适性"></a>英雄之路的普适性</h3><p>真理只有一个，而圣人用各种不同的名字称呼它。无论是从古老神话传说，还是现当代的小说电影都可以看到英雄之路的原型。</p>
<h5 id="代表人物"><a href="#代表人物" class="headerlink" title="代表人物"></a>代表人物</h5><ul>
<li>释加牟尼</li>
<li>盗火者普罗米休斯</li>
<li>耶稣</li>
<li>穆罕默德</li>
<li>鲁智深</li>
<li>贾宝玉</li>
<li>孔子</li>
<li>等等</li>
</ul>
<h3 id="英雄之路的三大阶段"><a href="#英雄之路的三大阶段" class="headerlink" title="英雄之路的三大阶段"></a>英雄之路的三大阶段</h3><p><img src="https://upload-images.jianshu.io/upload_images/5071176-e40200300bfa7518.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/473/format/webp" alt="img"></p>
<p>概括的说：<strong>故事从启程阶段开始，潜在的英雄接收到冒险召唤，初次抵触，到启蒙阶段，与智者相遇，跨越边界，开始初次尝试，到历险阶段的深入洞穴，经历严峻考验，最后到回归阶段，踏上返回之路，复活而归。</strong></p>
<h4 id="一：启程：放弃当下的环境，开始冒险"><a href="#一：启程：放弃当下的环境，开始冒险" class="headerlink" title="一：启程：放弃当下的环境，开始冒险"></a>一：启程：放弃当下的环境，开始冒险</h4><ul>
<li>起初：平凡世界<ul>
<li>超人的童年</li>
<li>彼得在成为蜘蛛侠之前</li>
</ul>
</li>
<li>冒险的召唤<ul>
<li>释迦摩尼遇到老人、病人、死人和苦行僧后，开始向往修行</li>
<li>超人偶然发现了自身的超能力</li>
<li>蝙蝠侠在父母遇害后，立志打击罪犯</li>
</ul>
</li>
<li>拒绝召唤<ul>
<li>绿巨人拒绝自身的力量，在非洲隐居</li>
</ul>
</li>
<li>英雄得到了智慧长者的帮助，碰见导师<ul>
<li>灰姑娘遇到的神仙教母</li>
<li>美人鱼遇到的巫婆</li>
<li>养父母肯特夫妇担当超人的导师角色</li>
<li>风清扬教授令狐冲独孤九剑</li>
<li>孙悟空立志追求长生不老时，通臂猿猴的指引</li>
</ul>
</li>
<li>跨过第一道边界<ul>
<li>孙悟空出海求道</li>
<li>超人开始担当英雄的责任</li>
</ul>
</li>
<li>鲸鱼之腹：通过边界后进入的重生蜕变之地</li>
</ul>
<h4 id="二：启蒙（获得领悟）和考验（陷入险境，进行战斗）"><a href="#二：启蒙（获得领悟）和考验（陷入险境，进行战斗）" class="headerlink" title="二：启蒙（获得领悟）和考验（陷入险境，进行战斗）"></a>二：启蒙（获得领悟）和考验（陷入险境，进行战斗）</h4><ul>
<li><p>英雄遭遇考验并遇到帮手，考验，伙伴和敌人</p>
<ul>
<li>西游记中的取经之路，九九八十一难</li>
<li>《绿野仙踪》里面的小女孩桃乐丝在路上碰到了她的伙伴：稻草人，铁皮人和狮子</li>
</ul>
</li>
<li><p>英雄抵达最深的洞穴，或者这个异世界的中心</p>
<ul>
<li>西游记一行人到达了西天</li>
<li>阿凡达电影中的男主角进入潘多拉星球，开始反抗人类的计划</li>
</ul>
</li>
<li><p>磨难，英雄的命运坠入谷底，面临死亡的危险，</p>
<p>（也可以看做，外部的磨难伴随着内在对于生与死的看法，原来的自我认知在极限的压力下轰然倒塌，美好的幻境被打碎，一个全新的自我概念悄然形成）</p>
<ul>
<li>西天里面的凌云渡无底船脱去凡胎，大鹏鸟抢经等</li>
<li>耶稣被钉十字架</li>
<li>钢铁侠一次又一次的战胜对手</li>
</ul>
</li>
<li><p>英雄得到了圣剑，报酬（内心的升华，以及达成所愿）</p>
<ul>
<li>圣剑，报酬可以是名誉，地位，神器，财宝，力量等</li>
</ul>
</li>
</ul>
<h4 id="三：归来：回归正常生活（再次离开当下的舒适区）"><a href="#三：归来：回归正常生活（再次离开当下的舒适区）" class="headerlink" title="三：归来：回归正常生活（再次离开当下的舒适区）"></a>三：归来：回归正常生活（再次离开当下的舒适区）</h4><p>冒险归来后，英雄的整个人格已经有了很大的改变，好比如已经成为了神仙。此时再回到凡间做凡人，显然是比较困难的。此时遇到的障碍是多方面的</p>
<ol>
<li><p>外界的障碍</p>
<p>在踏上归程的路上，会有各种各样的追踪者阻碍回归。</p>
<ul>
<li>电影中常见的追逐场景</li>
</ul>
</li>
<li><p>内心的障碍</p>
<p>经历冒险的内心无法适应正常生活，导致堕落。</p>
<ul>
<li>屠龙勇士成为了恶龙</li>
</ul>
</li>
<li><p>民众无法接受</p>
<p>英雄获得的启示、道理无法被人们所接受，导致无法回归正常生活</p>
<ul>
<li>天龙八部里面的萧峰为了缓和宋辽两国之间的民族矛盾，换取几十年的和平，自尽身亡，究其本质是当时宋辽两国都无法接受他和平的主张</li>
<li>从老家离开到新的地方生活学习和工作，回到老家后会有隔阂</li>
</ul>
</li>
</ol>
<p>只有克服了种种障碍，走上归来之路，将收获到的启示，财富进行分享，与开始形成一个闭环，这段英雄之路才算是真正的走完，否则就是被困其中。</p>
<p>成功回归的例子：</p>
<ul>
<li>张无忌辞去明教教主之位隐居</li>
<li>超人回到地面，像一个普通人一样从事报社记者的职业</li>
<li>哈利波特战胜伏地魔后保持低调,在家人和世人面前仍旧保持着普通巫师的形象</li>
</ul>
<h2 id="踏上英雄之路……"><a href="#踏上英雄之路……" class="headerlink" title="踏上英雄之路……"></a>踏上英雄之路……</h2><ol>
<li>拒绝舒适区，接受挑战</li>
<li>寻求朋友和导师的帮助</li>
<li>明确敌友，以及自己想要什么</li>
<li>可以忍受磨难，知道自己必须舍弃一些东西才能强大</li>
<li>是否战胜敌人并不重要，因为最终必有所获</li>
<li>神话之旅的终点是要回到当下</li>
<li>可以有意识的寻找自己目前的生活对应属于英雄之路哪一个阶段</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2020/08/02/学箭悟禅录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/02/学箭悟禅录/" itemprop="url">学箭悟禅录 杂记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-02T18:40:31+08:00">
                2020-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="内容简介"><a href="#内容简介" class="headerlink" title="内容简介"></a>内容简介</h2><p>“德国哲学家赫里格尔先生在日本向弓道大师学习六年，回国后他记下了通过亲身体会所感悟到的东方禅文化。由于作者将抽象玄奥、高深莫测的禅和他在日本学习射箭的具体过程联系起来谈论，使得神秘的“禅”在他的笔下变得有血有肉、生动真切，因而具有特别强的感染力和说服力。此书德文原版1948年出版后，60年来，一版再版，被翻译成多种语言版本。至今仍被西方人视为了解“禅”的最佳著作之一。”</p>
<p>​                                                                                                                                                                                                         ——摘录自豆瓣</p>
<h2 id="章节小思"><a href="#章节小思" class="headerlink" title="章节小思"></a>章节小思</h2><h3 id="中和之道"><a href="#中和之道" class="headerlink" title="中和之道"></a>中和之道</h3><p>首先这是余觉中先生为这本书写的一篇序言。文如其名，紧扣中字，但是在我看来，余先生有失偏颇。儒家有中，佛老也有中，为何偏说儒家之中，更说自孔孟之后分为三教？显然这是不合乎实际的。由此，我对其为人治学已有怀疑。再看这本书，讲的是学箭悟禅，显然离佛更近一些，却偏偏舍近而求远，不是很奇怪么</p>
<h3 id="铃木大拙序"><a href="#铃木大拙序" class="headerlink" title="铃木大拙序"></a>铃木大拙序</h3><p>讲了属于无艺之艺的弓道，讲了禅，最后讲述了二者的联系</p>
<h3 id="赫里戈尔德觉悟"><a href="#赫里戈尔德觉悟" class="headerlink" title="赫里戈尔德觉悟"></a>赫里戈尔德觉悟</h3><p>着重围绕觉悟展开。赫里戈尔练习弓道，是为了什么？觉悟而已。</p>
<h3 id="新版译者序，初版译者序"><a href="#新版译者序，初版译者序" class="headerlink" title="新版译者序，初版译者序"></a>新版译者序，初版译者序</h3><p>本书创作、翻译的因缘</p>
<h3 id="第一章-弓道和禅"><a href="#第一章-弓道和禅" class="headerlink" title="第一章 弓道和禅"></a>第一章 弓道和禅</h3><p>弓道，也就是射箭的艺术，不能单单的看作是一种运动或者争斗之术，这种角色的属性在现当代已经渐渐失去。它更多的是一种修行炼心的精神训练手段。射的目标也不是靶子、敌人，而是我执。不单单是弓道，茶道、插花和剑道等都是如此。凡一种事，只有在意识到其具有的精神价值，便成了走向解脱的窄门。</p>
<h3 id="第二章-学禅缘由"><a href="#第二章-学禅缘由" class="headerlink" title="第二章 学禅缘由"></a>第二章 学禅缘由</h3><p>作者选择禅作为其走向解脱的手段，是因为解脱是一种体验，而非分析的结果。解脱所在之地，正如空中之花，水中之火，超乎逻辑言语之外。没有体验，一切都是空话。</p>
<h3 id="第三章-神意拉弓"><a href="#第三章-神意拉弓" class="headerlink" title="第三章 神意拉弓"></a>第三章 神意拉弓</h3><p>稳当的呼吸，然后得到精神的放松，继而身体得到放松，便能自然而然不可以的拉弓，也就是神意拉弓。</p>
<h3 id="第四章-放箭难关"><a href="#第四章-放箭难关" class="headerlink" title="第四章 放箭难关"></a>第四章 放箭难关</h3><p>作者一直找不到放箭合适的时机，总是紧张，导致放箭时身体不稳，箭也摇摇晃晃。</p>
<h3 id="第五章-放下自我"><a href="#第五章-放下自我" class="headerlink" title="第五章 放下自我"></a>第五章 放下自我</h3><p>导师要求他放下对射的执着，然后才能在合适的时机自然的让箭射出去。</p>
<h3 id="第六章-以心传心"><a href="#第六章-以心传心" class="headerlink" title="第六章 以心传心"></a>第六章 以心传心</h3><p>作者显然无法立刻领会，长久的失败让他自认为找到了捷径——通过技巧来弥补，但这显然是导师极为反对的。最终作者“自暴自弃”，仍然练箭，但是已经不追求射出去，这反而破除了对射箭的执着，做到了“‘它’射出去了”！</p>
<p>在把箭射出去后，进入射靶子的阶段。在这个阶段和上个阶段相同。也就是这个阶段的最后，作者消除了我与射箭的界限，二者融为一体，消除了自我，也就是“弓弦现在终于能如意地切过你了”。</p>
<h3 id="第七章-结业考核"><a href="#第七章-结业考核" class="headerlink" title="第七章 结业考核"></a>第七章 结业考核</h3><p>五年多的练习，作者终于完成了对学箭，也悟到了禅。但这只是走上解脱的开始，导师的工作也仅仅是帮他引入门口。在我看来，后面是师生，更是同道之友。</p>
<h3 id="后面的章节"><a href="#后面的章节" class="headerlink" title="后面的章节"></a>后面的章节</h3><p>作者首次在悟道之后，谈论了弓道与禅的关系，由此推出所有的无艺之艺，都是禅的门径，都能引人走向解脱。比如单独开辟一章讲的剑道。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2020/08/02/摘录《神话的力量在诸神与英雄的世界中发现自我》/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/02/摘录《神话的力量在诸神与英雄的世界中发现自我》/" itemprop="url">摘录《神话的力量:在诸神与英雄的世界中发现自我》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-02T18:39:29+08:00">
                2020-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>造成所有苦难的原因，就是生命必然会死去这个事实。假如生命被肯定，死亡便无法被否定。</p>
</li>
<li><p>生命远非人智所及，它由伟大的孤寂中诞生，只有从苦难中才能触及。只有困厄与苦难才能使心眼打开，看到那不为他人所知的一</p>
</li>
<li><p>了解世界的一条可靠之路，便在书本当中。</p>
</li>
<li><p>掌管命运的三个女神会引导有志者，随波逐流的人则被她们牵着鼻子走。</p>
</li>
<li><p>生命的本质是杀生与饮食，那就是神话所要处理的重大奥秘。</p>
</li>
<li><p>这就是宗教的崇高信息，只要你在这当中至少为一个人做了事……</p>
</li>
<li><p>真理只有一个，圣贤以许多不同的名字称呼它</p>
</li>
<li><p>生命的不完美正是它的可爱之处。</p>
</li>
<li><p>大家认为生命的意义就是人类所追求的一切。我并不这样认为。我认为人类真正追求的是一种存在的体验，因为这种体验，我们一生的生活经验才能和内心的存在感与现实感产生共鸣，我们才能真正体会到存在的喜悦。那就是生命，神话是帮助我们发现内在自我的线索。</p>
</li>
<li><p>人们的心总是在追寻意义。一朵花的意义是什么呢？</p>
</li>
<li><p>存在本身是不需要赋予人为意义的。它就是在那里，如此而已。你的意义就是你的存在。人类一直汲汲于追求外在价值，却忘了本来便存在的内在价值，这种内在价值就是存在本身的喜悦，也就是生命的意义。</p>
</li>
<li><p>婚姻是人生中的一个神话体验。如果结婚是为了永远恋爱下去，夫妻很快便会离婚，因为所有的恋曲都会以失望告终。婚姻应该是去体验一种心灵上的契合。</p>
</li>
<li><p>我们能与合适的对象结婚，等于重新把具体化的上帝融入生活中，这就是婚姻。</p>
</li>
<li><p>婚姻是一种人际关系，如果你曾经为婚姻牺牲了什么，你并不是为对方牺牲，而是为一种关系的结合而牺牲。</p>
</li>
<li><p>婚姻不单只是谈恋爱，它是一种痛苦的体验，一种牺牲自我的痛苦体验，为的是维持两者合一的关系。</p>
</li>
<li><p>炼金术婚姻</p>
</li>
</ol>
<p>Notes: 1) 婚姻的俩个阶段:1青春期婚姻,为了生育的目的,停在这一阶段,在孩子长大后容易分开。2炼金术婚姻,二者合为一个,削弱了单独的自我,这样是上帝祝福的。 </p>
<ol start="17">
<li><p>婚姻主要是一种精神层面的学习，社会应该帮助个人意识到婚姻的这一层面。不应该由个人来配合社会，相反，社会应该为个人提供这项服务。如果由个人来迎合社会，社会就会变成一个怪物，这也是目前威胁世界稳定的因素。</p>
</li>
<li><p>旧社会的宗教属于另一个年代、另一群人、另一套人类价值、另一个世界。回到过去是将自己丢入相同的历史轮回中。我们的下一代对宗教失去信心，他们因而走入自己的内心世界。</p>
</li>
<li><p>精神崩溃是湮没在一片浮动着神秘体验的大海中，身在其中者必须要有心理准备才行。</p>
</li>
<li><p>整个生命本身就是一场冥想，其大部分过程都是非意志性的。</p>
</li>
<li><p>神话的功能便是将我们带入一种心灵层面的意识状态。</p>
</li>
<li><p>你和几百万年前的人有同样的躯体，同样的身体体验，因此你们对同样的意象会有反应。</p>
</li>
<li><p>所有的神、所有的天堂、所有的世界都在我们心中。他们是放大的梦，所有的梦都是相互冲突的身体能量通过意象表现出来的形式。这就是神话</p>
</li>
<li><p>首先，你要记住梦的内容，并且记录下来。然后截取梦里的小片段，比如一两个意象或概念，并找出它们的关联性。一次次写下你心中的意象，你就会发现梦境的基础是人生经验，这些经验在你生命中不但很重要，而且会一直影响着你，只是你不知道而已。很快你会再做梦，你对梦的解析也会更深入。</p>
</li>
<li><p>生命的真谛便是吃掉生命本身。生命依靠生命而生存。</p>
</li>
<li><p>来看生命，那是极其恐怖的。因此在蛇身上同时存在生命的迷人之处和恐怖之处。</p>
</li>
<li><p>在蛇身上同时存在生命的迷人之处和恐怖之处。</p>
</li>
<li><p>生命靠杀生及吃掉其他生命来维持，靠摆脱死亡再重生来延续，就像月亮一样。</p>
</li>
<li><p>如果你满脑子想的都是自己的原罪，那么你便会成为一个罪人。</p>
</li>
<li><p>把生命看成苦难，通过苦难，把自己从生命的桎梏中解放出来，这是较高层次的宗教。</p>
</li>
<li><p>不要评判你不评判的</p>
</li>
<li><p>我们的诞生只是一睡与一醒； 我们的生命之星、灵魂，和我们一同早起， 却在别的地方落下去， 并且来自远方。”</p>
</li>
<li><p>根据你的神话是把自然看成堕落，还是把自然和心灵本身看成神性的展现，你会有一种完全不同的文明，以及完全不同的生活方式。</p>
</li>
<li><p>坐在房间里读书、读书、再读书，而且要读对书，读对的人写的书。你的心就会被带到某个层次，你可以因此一直拥有一种美好、温和、慢慢燃烧的喜悦。这种对生命的理解，可以成为你生活中的一种常态。当你发现一个真正能抓住你心的作者时，就把他所有的作品都读完。不要说“我想知道某某某写的东西”，也不要被畅销书排行榜所困扰。 只去读这一位作者想要告诉你的。然后去读这位作者读过的东西。这时世界便以某种一致的观点豁然开朗。</p>
</li>
<li><p>当耶稣说，“爱你的邻人，就像爱自己一样”。他实际上是说，“爱你的邻人，因为他就是你自己”。</p>
</li>
<li><p>除非你有过去，否则不可能有未来。如果你爱上了现在，不论它是什么都将变成过去。失去、死亡，失去、死亡就这样周而复始下去。冥思十字架就是冥思人生奥秘的象征。</p>
</li>
<li><p>上帝的儿子到尘世来受十字架处死之苦，乃是为了让我们的心觉醒，变得慈悲，也使我们把心从对世俗生活的眷恋，转移到人类在分享苦难中特有的自我付出价值。</p>
</li>
<li><p>我和天父是一体的。</p>
</li>
<li><p>我与可敬的上帝是一体的</p>
</li>
<li><p>我的主，假如你曾教导这些人你所教我的道理，他们就不会这样对待我。假如你没有这样教我，这也不会发生在我身上。让我赞美主与它的作为”</p>
</li>
<li><p>我甚至有个迷信，因为看不见的手一直帮助我，所以我相信，如果你循着内心直觉的喜悦而行，你就走上了一条早已等待着你的轨道，你应该过的生活，就是你正在过的生活。当你可以看到这一层时，你便开始遇见你想要遇见的人，而且他们会为你开启心门。遵循你内心直觉的喜悦，不要恐惧，那么这扇门就会为你而开，而你无法预期它会带你到哪里去。</p>
</li>
<li><p>你认为你可以不经历在你之前死去的人们所经历的试炼，便能进入充满极乐的伊甸园吗？</p>
</li>
<li><p>通往生命的门很宽，而路是窄的，极少人能发现它。</p>
</li>
<li><p>危险的道路就像剃刀的锋口一样</p>
</li>
<li><p>当你遵循欲望、热情和情绪的道路时，要不断控制你的心，别让它强行把你拖入灾难中。</p>
</li>
<li><p>奥德修斯的悲剧精神正如来自于人生美丽和优越的深度快乐。也就是窈窕淑女的高贵可爱、男子气概和男人的真正价值等。但故事的结束却是尘土灰烬</p>
</li>
<li><p>你不能因为它的终点是坟墓，就说生命是无用的。</p>
</li>
<li><p>一天的生物，它是什么？又不是什么？人只是一个阴影的梦。然而当从天堂射下一道阳光，就像对人的恩赐，人就是沐浴在阳光下的一个温柔的生命。</p>
</li>
<li><p>假如我们过自己的生活，而不是模仿他人的生活，那当然也是要经历一番寻求才能得到的。</p>
</li>
<li><p>童话是孩子的神话。不同时期的人生各有其最贴切的神话。当你年纪渐长，你需要的是让你更坚强的神话。</p>
</li>
<li><p>欲望与恐惧是控制世界上所有生命的两种情绪。欲望是饵，死亡是钓钩。</p>
</li>
<li><p>坚持你对你自己的理想，就像天行者卢克一样，拒绝外在系统强加在你身上的非人性要求。</p>
</li>
<li><p>你被你的生活所塑造。</p>
</li>
<li><p>只有你自己才可能把你内在的潜力表现在生活中，其他人都不可能。</p>
</li>
<li><p>一个人在生命里必须寻求的，绝不是一块土地或海洋，而必须是从他自己独特的经验潜能所发生的东西，是那未曾也不可能被他人经历的东西。</p>
</li>
<li><p>只有当一个人不把死亡当做是生命的对立，而是将其作为生命的一面来接受它时，人才可能体验到对生命的无条件肯定。生命在生成变化里一直在死亡中、死亡点上。克服了恐惧，生命的勇气便油然而生。无惧是每个英雄冒险历程的主要开端。</p>
</li>
<li><p>你只有一生可活，你不需要为他人而活。要活得专注!</p>
</li>
<li><p>你必须把你自己的心放在你觉得最快乐的时刻中。这种快乐不是兴奋或战栗，而是深度的喜悦。这需要一点自我分析。是什么让你快乐，你就保持它，不管别人说什么。这是我所谓的“遵循你内心直觉的喜悦”。</p>
</li>
<li><p>我们要遵循自己的路，而不是父母亲的路。</p>
</li>
<li><p>爱你的敌人，因为他们是你命运的凭借。</p>
</li>
<li><p>生命是与苦难共存的。</p>
</li>
<li><p>你吞下去的魔鬼会给你它的力量，而且越大的人生痛苦，可以得到越大的人生回馈。</p>
</li>
<li><p>你的生命是你自己行为的果实。你不能怪别人，只能怪自己。</p>
</li>
<li><p>任何人在生活中，都有体验到精神上狂喜的可能。你要做的只是去认识它、接纳它、修炼它，并与它同在。当人们说到平凡的朽物，我总觉得不舒服，因为我从未见过一个平凡的人。</p>
</li>
<li><p>发现父亲，就是发现你自己的人格特质与命运。</p>
</li>
<li><p>英雄与半神人乃是因为慈悲而生，并非为权力、性欲或维持生物生命而生。</p>
</li>
<li><p>所以人可以从动物般的肉欲，通过精神的死亡而再生。第二次出生的，是欢愉的精神生命。</p>
</li>
<li><p>“在耶稣中，没有男女。”就事物终极的意义而言，是超越两者</p>
</li>
<li><p>心是开放给另一个人的器官。这是人类不同于动物的特质，因为动物只关心自己的利益。</p>
</li>
<li><p>真正的婚姻要认识到自己与对方是一体的。生理的结合只不过是肯定这层意义的圣礼。婚姻不能反其道而行，从生理的兴趣提升到精神层次是不可能的。</p>
</li>
<li><p>对于那些在地狱里且不是天使的人来说，炼火并不是痛苦的火焰，而是欢乐的火焰。</p>
</li>
<li><p>社会的功能是在培养个体，并不是以个体来支援社会。</p>
</li>
<li><p>爱是社会许多功能中的一项。如果企图以某一种功能控制整个系统，而不是帮忙建立整个系统的秩序，那么这是会造成社会混乱的。</p>
</li>
<li><p>爱情测验在本质上是要确定这个男人会为爱而忍受一切，他不是为情欲才如此的。</p>
</li>
<li><p>是我的热情造成这个伤口，是我对这个特定个人的爱，才产生这极大的痛苦。因此唯一可以医好伤口的是开枪的人。</p>
</li>
<li><p>从我口中饮者，将成为我，而我也将成为他</p>
</li>
<li><p>婚姻就是婚姻，婚姻不是恋爱。恋爱是完全不同的一件事。婚姻是对你自己的一种承诺。你的婚姻伴侣实际上是另一半的你，而你和自己的另一半是一体的。恋爱不是这样，而是追求一种享乐的关系，而当它变得不快乐时，关系便结束。但是婚姻是一生的承诺，代表你对自己一生最主要的关怀。假如婚姻不是你的主要关怀，你等于没有结婚。</p>
</li>
<li><p>婚姻就是婚姻，婚姻不是恋爱。恋爱是完全不同的一件事。婚姻是对你自己的一种承诺。你的婚姻伴侣实际上是另一半的你，而你和自己的另一半是一体的。恋爱不是这样，而是追求一种享乐的关系，而当它变得不快乐时，关系便结束。但是婚姻是一生的承诺，代表你对自己一生最主要的关怀。假如婚姻不是你的主要关怀，你等于没有结婚。</p>
</li>
<li><p>清教徒视婚姻为“教会中的小教会”。在婚姻中我们天天在爱，天天在宽恕。它是爱与宽恕持续进行的圣礼。</p>
</li>
<li><p>婚姻就是你与自己内在女性倾向接触的方式。</p>
</li>
<li><p>爱不能使人对其他的关系免疫。但人是不是可以拥有一个完整的爱情，我是说一个真正完整的爱情，而同时还忠于婚姻呢？我认为那是不可能的。</p>
</li>
<li><p>只要是纯粹的爱情，就不会以社会同意的方式表现出来，那也是爱情如此神秘的缘故。</p>
</li>
<li><p>爱是生命的燃烧点，因为人生是悲苦的，爱也是如此。爱越强，痛苦也越大。</p>
</li>
<li><p>爱本身是苦，可以说是真正活着的痛苦。</p>
</li>
<li><p>当你凝神注视日落或山崖之美而发出‘啊’的赞叹时，你便融会在神性之中。</p>
</li>
<li><p>我们可以把奇妙、爱与恨看成是受到不同神明影响的结果。</p>
</li>
<li><p>祈祷是联系并冥想宇宙奥秘的修行。</p>
</li>
<li><p>罗马天主教有一种以念珠不断持诵同一祷辞的冥想方式，这就是把心带入修行中。在梵文中，这种修行叫做“持咒”（japa），意思是“重复神的名字”。它可以隔断其他的念头，而让你专注于一件事上，然后依据个人的想象，你可以体验到宇宙神秘力量不可测知的深度。</p>
</li>
<li><p>耶稣是历史上实际证悟到他与他所称的“天父”是“合一”的一个真实人物，而他终其一生都是以他生命本性中的基督精神而存在的。</p>
</li>
<li><p>除了神之外没有人能崇拜神</p>
</li>
<li><p>不要挑剔敌人眼中的微尘（小缺点），而要摘取自己眼中的横梁（大缺点）。没有人有资格可以否定敌人的生活方式。</p>
</li>
<li><p>爱你的敌人，并为那些处死你的人祈祷，所以你可以成为天父的子民；因为他让太阳在善与恶中升起，让雨在义与不义间降下</p>
</li>
<li><p>我愿相信。请上帝帮助我去除对你的不信</p>
</li>
<li><p>天国不会因人的祈求而到来。天国无所不在，而人却看不到它</p>
</li>
<li><p>当耶稣说，“从我口中喝水的人，将成为我，而我将成为他。”他是从所有存在物共同的存有基础，也就是我们所谓的基督这个观点出发，而有此说。任何人把这段话实践在生活中，他就等于是耶稣，这是这段话的精义所在。</p>
</li>
<li><p>当你在旅程中，发现目的地越来越远，你便认识到旅程便是真正的目的地</p>
</li>
<li><p>天国散布在每个角落，而人们看不见它。</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2020/06/05/Javascript中常见的设计模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Javascript中常见的设计模式/" itemprop="url">JS中常见的设计模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T22:53:10+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="设计模式的定义"><a href="#设计模式的定义" class="headerlink" title="设计模式的定义"></a>设计模式的定义</h2><ul>
<li><p>设计模式是<strong>前人总结出的，用于解决开发中某类问题的方法，可复用的解决方案</strong>；</p>
</li>
<li><p>我们在过去的开发中已经接触过设计模式，但当时可能不清楚这就是设计模式；</p>
</li>
<li><p>设计模式之间并不是互相独立的，往往一个功能需要多个设计模式的配合来实现；</p>
</li>
<li><p>每个设计模式面向的问题不同，根据这些模式的侧重点我们可以将其分成三大类：创建型设计模式、结构型设计模式、行为设计模式。当然，除了这三种外，还有其他未包含在内的设计模式。</p>
</li>
</ul>
<h2 id="设计模式的好处"><a href="#设计模式的好处" class="headerlink" title="设计模式的好处"></a>设计模式的好处</h2><ul>
<li>属于已经验证的一种解决方案</li>
<li>复用率高</li>
<li>更加具有表现力，方便沟通，描述解决方案</li>
</ul>
<h2 id="创建型设计模式"><a href="#创建型设计模式" class="headerlink" title="创建型设计模式"></a>创建型设计模式</h2><p>创建型设计模式： 主要用于创建对象，即不同场景下采用不同的方式来创建对象。主要包括单例模式、工厂模式、建造者模式以及原型模式等。</p>
<h4 id="1-单例模式"><a href="#1-单例模式" class="headerlink" title="1. 单例模式"></a>1. 单例模式</h4><p>单例模式（Singleton）：确保一个类只有一个实例。</p>
<ul>
<li>场景1</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    以完成一个弹窗的情景来理解</span></span><br><span class="line"><span class="comment">    封装一个弹窗，确保可以多次调用该弹窗</span></span><br><span class="line"><span class="comment">    为避免每次调用都新建一个弹窗，我们可以让所有的弹窗共用一个div元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">let</span> Popup = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">Popup.show = <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.innerText = arg;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(<span class="keyword">this</span>)</span><br><span class="line">&#125;;</span><br><span class="line">Popup.show(<span class="string">"张三"</span>);<span class="comment">//测试使用1</span></span><br><span class="line">Popup.show(<span class="string">"李四"</span>);<span class="comment">//测试使用2</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    抽象化，写成类的形式：</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">let</span> Popup = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> instance = <span class="literal">null</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pop</span></span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>()&#123;</span><br><span class="line">            <span class="keyword">if</span>( instance )&#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">this</span>.ele = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">            <span class="keyword">this</span>.show = <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.ele.innerText = arg;</span><br><span class="line">                <span class="built_in">document</span>.body.appendChild(<span class="keyword">this</span>.ele);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Pop;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> Popup();</span><br><span class="line">a.show(<span class="string">"张三"</span>);<span class="comment">//测试使用1</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Popup();</span><br><span class="line">b.show(<span class="string">"李四"</span>);<span class="comment">//测试使用2</span></span><br><span class="line"><span class="built_in">console</span>.log(a === b);<span class="comment">//测试单例</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//核心实现代码</span></span><br><span class="line"><span class="keyword">let</span> Single = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> instance = <span class="literal">null</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>()&#123;</span><br><span class="line">            <span class="keyword">if</span>(instance)&#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">this</span>;</span><br><span class="line">            <span class="comment">//code……</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">//实例化测试</span></span><br><span class="line"><span class="built_in">console</span>.log( <span class="keyword">new</span> Single() === <span class="keyword">new</span> Single() );</span><br></pre></td></tr></table></figure>
<ul>
<li>场景2</li>
</ul>
<p>当我们直接使用字面量来定义一个对象时，该对象时唯一的，此时也可以看作单例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Single = &#123;</span><br><span class="line">    <span class="comment">//code        </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>将需要用到的相关的属性或方法全部放到某对象里面，减少了对全局变量的占用，也方便使用。此外，在多人协作开发的场景下，还可以避免命名冲突的问题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> name = <span class="string">'Kate'</span>;</span><br><span class="line"><span class="keyword">let</span> eat = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上几个变量可以统一放在一个对象里面</span></span><br><span class="line"><span class="keyword">let</span> AMan = &#123;</span><br><span class="line">    age : <span class="number">10</span>,</span><br><span class="line">    name : <span class="string">'Kate'</span>,</span><br><span class="line">    eat()&#123;</span><br><span class="line">        <span class="comment">//code</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//有些时候我们希望隐藏某些变量，只有内部能访问：</span></span><br><span class="line"><span class="keyword">let</span> AObj = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> NUM = <span class="number">10</span>;<span class="comment">// 内部私有属性</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        addNum()&#123;</span><br><span class="line">            <span class="keyword">return</span> ++NUM;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log( AObj.NUM ); <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log( AObj.addNum() ); <span class="comment">// 11</span></span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>当需求实例唯一、命名空间时，就可以使用单例模式。</p>
<h4 id="2-工厂模式"><a href="#2-工厂模式" class="headerlink" title="2. 工厂模式"></a>2. 工厂模式</h4><p>工厂模式（Factory）：通过一个统一的接口来创建指定的对象。工厂模式又包括 <em>简单工厂模式</em> 、<em>抽象工厂模式</em>和<em>工厂方法模式</em>两种。</p>
<ul>
<li>场景1</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//牛排店</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Steak</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">30</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//烧烤店</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grill</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">15</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//面条店</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Noodles</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">15</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> Steak(); <span class="comment">//一份牛排</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Grill(); <span class="comment">//一份烧烤</span></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> Noodles(); <span class="comment">//一份面条</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//三个类结构相似，写和调用比较繁琐、重复：</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//牛排</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Steak</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">30</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//烧烤</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grill</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">15</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//面条</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Noodles</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">15</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//把三个类统一到一个类Shop里面</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shop</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name)&#123;</span><br><span class="line">        <span class="keyword">let</span> o = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">switch</span>(name)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Steak"</span>:</span><br><span class="line">                o = <span class="keyword">new</span> Steak();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Grill"</span>:</span><br><span class="line">                o = <span class="keyword">new</span> Grill();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Noodles"</span>:</span><br><span class="line">                o = <span class="keyword">new</span> Noodles();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//统一方法调用</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> Shop(<span class="string">"Steak"</span>); <span class="comment">//老板来份牛排</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Shop(<span class="string">"Grill"</span>);<span class="comment">//老板来份烧烤</span></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> Shop(<span class="string">"Noodles"</span>);<span class="comment">//老板来份面条</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口已经统一，但是如果想要增加新品种菜，我们就需要再创建一个类，然后再Shop里面调用，扩展性低，所以可以将菜品类写成Shop的方法，此时只有一个Shop类：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shop</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>[name].call(&#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    Steak()&#123;<span class="comment">//牛排</span></span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">30</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Grill()&#123;<span class="comment">//烧烤</span></span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">15</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Noodles()&#123;<span class="comment">//面条</span></span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">15</span>;</span><br><span class="line">        <span class="keyword">this</span>.time = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//统一方法调用</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> Shop(<span class="string">"Steak"</span>); <span class="comment">//老板来份牛排</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Shop(<span class="string">"Grill"</span>);<span class="comment">//老板来份烧烤</span></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> Shop(<span class="string">"Noodles"</span>);<span class="comment">//老板来份面条</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//需要扩展时，仅需再Shop中增加新的方法</span></span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>工厂模式就是把同一类别的类综合起来，通过统一接口创建，扩展性以及可修改性高。</p>
<h4 id="3-建造者模式"><a href="#3-建造者模式" class="headerlink" title="3. 建造者模式"></a>3. 建造者模式</h4><p>建造者模式（Builder）：通俗的说，就是使用多个简单的对象一步一步构建成一个复杂的对象，建造者模式又叫做生成器模式。</p>
<p>看名称我们首先想到的就是造房子。建造者模式就像是施工队，在了解了客户的建房需求后，将需求分解成多个子任务，分配给团队的各小组。各小组分工合作最终得到需求的房子。</p>
<ul>
<li>场景1</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Builder = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//成员01 -- 决定厅室</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Rooms</span>(<span class="params">member</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( member &lt;= <span class="number">0</span> )&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"入住人数错误！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.rooms = member&gt;=<span class="number">3</span>?<span class="number">3</span>:<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//成员02 -- 决定面积</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">FloorSpace</span>(<span class="params">budget</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( (<span class="keyword">typeof</span> budget !== <span class="string">"number"</span>) || <span class="built_in">Number</span>.isNaN(budget) || (budget &lt; <span class="number">60</span>) )&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"预算过低或错误！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.budget = budget/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//成员03 -- 整体风格</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Style</span>(<span class="params">style</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.style = style || <span class="string">"常规风格"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> </span>&#123;</span><br><span class="line">        <span class="comment">//住几人，预算多少(万)，风格</span></span><br><span class="line">        <span class="keyword">constructor</span>(member, budget, style) &#123;</span><br><span class="line">            Rooms.call(<span class="keyword">this</span>,member);</span><br><span class="line">            FloorSpace.call(<span class="keyword">this</span>,budget);</span><br><span class="line">            Style.call(<span class="keyword">this</span>,style);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//包工头获取客户需求，然后建造房子</span></span><br><span class="line"><span class="keyword">let</span> house1 = <span class="keyword">new</span> Builder(<span class="number">1</span>,<span class="number">100</span>,<span class="string">"小清新"</span>);<span class="comment">//客户1的需求</span></span><br><span class="line"><span class="keyword">let</span> house2 = <span class="keyword">new</span> Builder(<span class="number">4</span>,<span class="number">200</span>,<span class="string">"欧美"</span>);<span class="comment">//客户2的需求</span></span><br></pre></td></tr></table></figure>
<p>建造者模式中有两个重要组成，一个是建造者，如上成员01，成员02以及成员03，另一个则是把这些建造者组合起来，如上Builder。</p>
<p><strong>总结：</strong>当我们构造的对象，内部结构较复杂时，使用建造者模式将内部各模块分开创建就非常合适。</p>
<h4 id="4-原型模式"><a href="#4-原型模式" class="headerlink" title="4. 原型模式"></a>4. 原型模式</h4><p>原型模式（Prototype）：用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。可以看作是基于原型继承的模式，创建对象作为其他对象的原型。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(x)&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">    &#125;</span><br><span class="line">    showX()&#123;</span><br><span class="line">        alert( <span class="keyword">this</span>.x );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//子类A</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildA</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(x,y)&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">    showY()&#123;</span><br><span class="line">        alert( <span class="keyword">this</span>.y );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//子类B</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildB</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(x,z)&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.z = z;</span><br><span class="line">    &#125;</span><br><span class="line">    showZ()&#123;</span><br><span class="line">        alert( <span class="keyword">this</span>.z );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>多个类具有相同的属性或方法，那我们就可以通过原型继承来创造出类或者实例对象。</p>
<h2 id="结构性设计模式"><a href="#结构性设计模式" class="headerlink" title="结构性设计模式"></a>结构性设计模式</h2><p>结构性设计模式 – 通常与对象组合有关，关注于将多个类或对象组合成一个大的系统，方便使用。该模式有助于确保在系统某一部分变化时，仅需改变系统中对应的部分，而不需要改变整个结构。该类模式中常见的包括外观模式、适配器模式以及装饰器模式等。</p>
<h4 id="1-外观模式"><a href="#1-外观模式" class="headerlink" title="1. 外观模式"></a>1. 外观模式</h4><p>外观模式（Facede）：将一组子接口统一为一个接口，这样调用起来更加方便，比较常见的应用场景就是对浏览器各种API的兼容处理。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以添加事件为例：使用事件添加方式 addEventListener，但是IE不兼容，需要使用attachEvent，从而添加一个click的事件写法如下：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">click</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="built_in">document</span>.addEventListener )&#123;</span><br><span class="line">    oDiv.addEventListener(<span class="string">"click"</span> , click, <span class="literal">false</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">document</span>.attachEvent)&#123;</span><br><span class="line">    oDiv.attachEvent(<span class="string">"onclick"</span> , click);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    oDiv.onclick = click;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//封装一下：</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEvent</span>(<span class="params">dom , eName , fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( <span class="built_in">document</span>.addEventListener )&#123;</span><br><span class="line">        dom.addaddEventListener(eName,fn,<span class="literal">false</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">document</span>.attachEvent )&#123;</span><br><span class="line">        dom.attachEvent(<span class="string">"on"</span>+eName,fn);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        dom[<span class="string">"on"</span>+eName] = fn;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line">addEvent(oDiv , <span class="string">"click"</span> ,click);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">click</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>把这些相应的兼容操作综合起来，通过外观模式就能封装成一个小型的js库。</p>
<p><strong>总结：</strong>对外提供统一的接口，内部封装各种子操作。这就是外观模式。</p>
<h4 id="2-适配器模式"><a href="#2-适配器模式" class="headerlink" title="2. 适配器模式"></a>2. 适配器模式</h4><p>适配器模式（Adapter）：将一个类的接口转换成另外一个接口，以满足用户需求，解决接口不一样而产生的兼容问题。</p>
<p>适配的概念通俗的说，可以类比读卡器、耳机转换器的作用。</p>
<ul>
<li>场景1</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//某个项目中我们接口拿到的数据data是数组格式。</span></span><br><span class="line"><span class="comment">//一段时间后，后端更新了数据结构，返回的数据变成了键值对形式，如果此时前端修改之前的代码比较复杂，就可以使用适配器模式，在拿到相应数据后，将格式转换为数组：</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    success : <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span><br><span class="line">        msg = [msg.name,msg.age,msg.marry];</span><br><span class="line">        <span class="comment">//调用done</span></span><br><span class="line">        done(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">done</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, length = msg.length; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="comment">//dosomething……</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>场景2</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 另外一种比较常见的场景是，对方法参数的处理。比如参数很多时，当使用以下方式传参，既要注意顺序，还要注意参数赋值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">name,age,sex,index</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//dosomething……</span></span><br><span class="line">&#125;</span><br><span class="line">fn(<span class="string">"张三"</span>,<span class="number">18</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用适配器模式，我们将参数合并成一个对象，在方法内部对参数对象结构获取相应的值。就可以避免以上问题</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;name,age,sex,index=<span class="number">1</span>&#125;=options;</span><br><span class="line">    <span class="comment">//dosomething……</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>由于各种原因，导致现有接口和之前的不一样，而修改比较麻烦时，就可以考虑使用适配器对接口进行适配。</p>
<h4 id="3-装饰者模式"><a href="#3-装饰者模式" class="headerlink" title="3. 装饰者模式"></a>3. 装饰者模式</h4><p>装饰者模式（Decorator）：在不改变原对象的基础上，对其进行包装扩展，旨在促进代码复用。看起来类似于原型模式，但是由于装饰本身对于类原有的基本功能不是必要的，不需要合并到超类，所以不选择原型模式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name,sex)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.writer = sex;</span><br><span class="line">    &#125;</span><br><span class="line">    showName()&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Abook = <span class="keyword">new</span> Teacher(<span class="string">"Abook"</span>,<span class="string">"Tom"</span>);</span><br><span class="line"><span class="comment">//code…… </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要对实例Abook进行扩展</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Decorator</span>(<span class="params">obj,type</span>)</span>&#123;</span><br><span class="line">    obj.type = type;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line">Decorator(Abook,<span class="string">"小说"</span>);</span><br><span class="line"><span class="comment">//code……</span></span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>装饰者模式可以动态的修改对象，而不用创建新的实例。</p>
<h4 id="4-桥接模式"><a href="#4-桥接模式" class="headerlink" title="4. 桥接模式"></a>4. 桥接模式</h4><p>桥接模式（Bridge）：将抽象部分与它的实现部分解耦，使得二者可以独立变化。</p>
<ul>
<li>场景</li>
</ul>
<p>用桥接模式联结多个类：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//基本类，实现部分</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//桥接类，抽象部分</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bridge1</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.a = <span class="keyword">new</span> A();</span><br><span class="line">        <span class="keyword">this</span>.b = <span class="keyword">new</span> B();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bridge2</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.b = <span class="keyword">new</span> B();</span><br><span class="line">        <span class="keyword">this</span>.c = <span class="keyword">new</span> C();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//code……</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>什么时候用到桥接？当一个系统中的多个实现部分都有相应的变化逻辑时，如果写在一起会导致结构复杂，可读性以及可维护性低。此时可以适应桥接模式，把抽象部分和实现部分分别抽离出来，然后组合使用。</p>
<h4 id="5-组合模式"><a href="#5-组合模式" class="headerlink" title="5. 组合模式"></a>5. 组合模式</h4><p>组合模式（Composite）：又称部分-整体模式，组合模式依据树形结构来组合对象，用来表示部分以及整体层次，使得用户对单个对象和组合对象的使用具有一致性。</p>
<p>常见的例子就是清理文件时，不管是删除单个文件还是文件夹都是一样的操作。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DOM树是典型的树形结构，</span></span><br><span class="line"><span class="comment">// 一个典型的应用场景就是JQ对DOM元素的处理。</span></span><br><span class="line">$(<span class="string">"#box"</span>).css(<span class="string">"color"</span> , <span class="string">'red'</span>); <span class="comment">// 单个id为box的元素</span></span><br><span class="line">$(<span class="string">".box"</span>).css(<span class="string">"color"</span> , <span class="string">"red"</span>); <span class="comment">// 一组类名为box的元素</span></span><br></pre></td></tr></table></figure>
<p>**总结：使用组合模式将部分组合成一个整体，忽略单个对象和多个对象的使用区别，统一调用接口。</p>
<h4 id="6-享元模式"><a href="#6-享元模式" class="headerlink" title="6. 享元模式"></a>6. 享元模式</h4><p>享元模式（Flyweight ）：通过共享大量细粒度的对象，避免拥有相同内容造成额外的开销。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//最常见的享元模式，具有相同的事件函数</span></span><br><span class="line">a.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;alert(<span class="keyword">this</span>.name)&#125;;</span><br><span class="line">b.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;alert(<span class="keyword">this</span>.name)&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用享元模式</span></span><br><span class="line"><span class="keyword">let</span> clickEvent = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;alert(<span class="keyword">this</span>.name)&#125;;</span><br><span class="line">a.onclick = b.onclick = clickEvent;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>享元模式就是相同的部分提出来或者采用其他形式优化掉，一般需要配合单例模式来实现。</p>
<h4 id="7-代理模式"><a href="#7-代理模式" class="headerlink" title="7. 代理模式"></a>7. 代理模式</h4><p>代理模式（Proxy）：为对象提供一个代理，用来控制对这个对象的访问。</p>
<p>代理模式就是通过代理访问对象而不是直接访问对象。具体应用可以参看ES6的Proxy。</p>
<h2 id="行为设计模式"><a href="#行为设计模式" class="headerlink" title="行为设计模式"></a>行为设计模式</h2><p>行为设计模式 – 专注于不同对象之间的通信。主要包括观察者模式、访问者模式以及迭代器模式等。</p>
<h4 id="1-观察者模式"><a href="#1-观察者模式" class="headerlink" title="1. 观察者模式"></a>1. 观察者模式</h4><p>观察者模式（Observer）：又叫发布-订阅模式，定义了一种一对多的关系，让多个观察者对象同时监听某一个对象，当该对象发生改变时，多个观察者对象也做出相应的改变。<br>典型的例子就是vue响应式的实现。</p>
<p>组成该模式的有两个关键部分：多个订阅者 和 消息发布者。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//事件绑定的机制，其实就是一种观察者模式</span></span><br><span class="line"><span class="comment">//事件触发的时候（发布消息）就执行对应的 事件函数（订阅者）</span></span><br><span class="line"><span class="comment">//代码省略</span></span><br></pre></td></tr></table></figure>
<h4 id="2-访问者模式"><a href="#2-访问者模式" class="headerlink" title="2. 访问者模式"></a>2. 访问者模式</h4><p>访问者模式（Visitor）：在不改变对象的前提下，定义作用于对象的新操作,js中常通过call/apply来实现。</p>
<ul>
<li>场景1</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> aMan = &#123;</span><br><span class="line">    addInfo()&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = <span class="number">18</span>;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"Tom"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">aMan.addInfo();</span><br><span class="line"></span><br><span class="line"><span class="comment">//给对象obj添加这两个属性</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">aMan.addAttr.call(obj);</span><br></pre></td></tr></table></figure>
<h4 id="3-迭代器模式"><a href="#3-迭代器模式" class="headerlink" title="3. 迭代器模式"></a>3. 迭代器模式</h4><p>迭代器模式（Iterator）：在不暴露对象内部结构的同时，按顺序地访问集合对象内部的各个属性。</p>
<p>常见的例子比如forEach，every，map等等。在ES6里面很多功能都是基于迭代器来实现的。迭代器包括内部迭代器和外部迭代器两种。</p>
<ul>
<li>内部迭代器</li>
</ul>
<p>迭代的过程在方法内部完成，在外部无法干涉迭代的进度，比如forEach：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">arr.forEach(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>外部迭代器</li>
</ul>
<p>必须通过外部的操作来执行下一步迭代，如ES6中.next()操作：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arrIterator = arr[<span class="built_in">Symbol</span>.iterator]();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( arrIterator.next() ); <span class="comment">//&#123;value:1,done:false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log( arrIterator.next() ); <span class="comment">//&#123;value:2,done:false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log( arrIterator.next() ); <span class="comment">//&#123;value:3,done:false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log( arrIterator.next() ); <span class="comment">//&#123;value:undefined,done:true&#125;</span></span><br></pre></td></tr></table></figure>
<p>js实现一个外部迭代器迭代数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Iterator = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">        length = arr.length;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        next : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                value : arr[index++],</span><br><span class="line">                done : index &gt;= length</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ES6定义了Object.keys等相关的方法，让我们能遍历对象的属性。ES6定义的Generator函数和async函数，让我们可以手动的控制函数执行的流程。</p>
<h4 id="4-状态模式"><a href="#4-状态模式" class="headerlink" title="4. 状态模式"></a>4. 状态模式</h4><p>状态模式（State Pattern）：当对象内部状态发生改变时，它的行为也对应的发生改变，使之看起来像是改变了这个对象。</p>
<p>当需求有多种状态，并在某些条件下会从一种状态变成另一种状态时，使用状态模式就很合适。</p>
<ul>
<li>场景 – 开关灯状态的切换</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不使用状态模式的常见写法</span></span><br><span class="line"><span class="keyword">const</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line"><span class="keyword">let</span> state = <span class="string">"off"</span>;</span><br><span class="line"><span class="keyword">let</span> switchFn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( state === <span class="string">"off"</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"from off to on"</span>);</span><br><span class="line">        state = <span class="string">"on"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>( state === <span class="string">"on"</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"from on to off"</span>);</span><br><span class="line">        state = <span class="string">"off"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">btn.onclick = switchFn;</span><br></pre></td></tr></table></figure>
<p>当某状态对应的逻辑需要修改，或者需要添加新的模式时，我们需要修改整个switchFn方法。此时显而易见，各状态之间耦合性高，所以我们可以对代码进行优化如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用状态模式</span></span><br><span class="line"><span class="keyword">let</span> Switch = &#123;</span><br><span class="line">    <span class="comment">//状态机</span></span><br><span class="line">    FSM : &#123;</span><br><span class="line">        on : &#123;</span><br><span class="line">            to : <span class="string">"off"</span>,</span><br><span class="line">            action : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"from on to off"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        off : &#123;</span><br><span class="line">            to : <span class="string">"on"</span>,</span><br><span class="line">            action : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"from off to on"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当前状态</span></span><br><span class="line">    currentState : <span class="string">"off"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化事件</span></span><br><span class="line">    init()&#123;</span><br><span class="line">        <span class="keyword">const</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line">        btn.onclick = <span class="keyword">this</span>.transition.bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//状态切换</span></span><br><span class="line">    transition()&#123;</span><br><span class="line">        <span class="keyword">const</span> s = <span class="keyword">this</span>.FSM[<span class="keyword">this</span>.currentState];</span><br><span class="line">        <span class="keyword">this</span>.currentState = s.to;</span><br><span class="line">        s.action();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>适用状态模式的常见场景：</p>
<pre><code>1. 对象的行为基于它的状态，对应的操作会改变它的状态；
2. 
</code></pre><ol start="2">
<li>存在大量的判断语句时，可以考虑使用状态模式进行消除。</li>
</ol>
<h4 id="5-策略模式"><a href="#5-策略模式" class="headerlink" title="5. 策略模式"></a>5. 策略模式</h4><p>策略模式（Strategy）：策略模式定义了一系列的算法，并将每一个算法封装起来，而且使他们可以相互替换，且具有一定的独立性。简单的说，就是一个类的行为或其算法可以在运行时更改。</p>
<p><em>一系列的算法，可以相互替换</em>，也就是说为了同一个目的，可能采取的算法不同。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//玩家类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.totalCost = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.level = <span class="string">"C"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    consum(price)&#123;</span><br><span class="line">        <span class="keyword">this</span>.totalCost += price;</span><br><span class="line">        <span class="keyword">let</span> result = Strategy.calc(<span class="keyword">this</span>.level , price);</span><br><span class="line">        <span class="keyword">this</span>.getLevel();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    getLevel()&#123;</span><br><span class="line">        <span class="keyword">let</span> totalCost = <span class="keyword">this</span>.totalCost;</span><br><span class="line">        <span class="keyword">if</span>( totalCost &gt;= <span class="number">50000</span> )&#123;</span><br><span class="line">            <span class="keyword">this</span>.level = <span class="string">"S"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>( totalCost &gt;= <span class="number">30000</span> )&#123;</span><br><span class="line">            <span class="keyword">this</span>.level = <span class="string">"A"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>( totalCost &gt;= <span class="number">20000</span> )&#123;</span><br><span class="line">            <span class="keyword">this</span>.level = <span class="string">"B"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.level = <span class="string">"C"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计价策略类</span></span><br><span class="line"><span class="keyword">let</span> Strategy = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//策略</span></span><br><span class="line">    <span class="keyword">let</span> s = &#123;</span><br><span class="line">        S(price)&#123;</span><br><span class="line">            <span class="keyword">return</span> price*<span class="number">0.85</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        A(price)&#123;</span><br><span class="line">            <span class="keyword">return</span> price*<span class="number">0.9</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        B(price)&#123;</span><br><span class="line">            <span class="keyword">return</span> price*<span class="number">0.95</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        C(price)&#123;</span><br><span class="line">            <span class="keyword">return</span> price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">//添加新策略的接口</span></span><br><span class="line">        addsty(name , fn)&#123;</span><br><span class="line">            s[name] = fn;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//计算策略对应最终价格的接口</span></span><br><span class="line">        calc(sty,price)&#123;</span><br><span class="line">            <span class="keyword">if</span>( s[sty] )&#123;</span><br><span class="line">                <span class="keyword">return</span> s[sty](price);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"对应的优惠策略不存在！"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//测试：</span></span><br><span class="line"><span class="keyword">let</span> afei = <span class="keyword">new</span> Player();</span><br><span class="line"><span class="built_in">console</span>.log(afei.consum(<span class="number">20</span>));</span><br><span class="line"><span class="built_in">console</span>.log(afei.consum(<span class="number">10000</span>));</span><br><span class="line"><span class="built_in">console</span>.log(afei.consum(<span class="number">50000</span>));</span><br><span class="line"><span class="built_in">console</span>.log(afei.consum(<span class="number">200</span>));</span><br></pre></td></tr></table></figure>
<h4 id="6-命令模式"><a href="#6-命令模式" class="headerlink" title="6. 命令模式"></a>6. 命令模式</h4><p>命令模式（Command）：基于传入的参数进行驱动，将请求与实现解耦并封装成独立对象，从而使不同的请求对客户端的实现参数化。</p>
<ul>
<li>场景</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> CanvasCmd = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"canvas"</span>),</span><br><span class="line">        ctx = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line">    <span class="keyword">let</span> cmdList = &#123;</span><br><span class="line">        beginPath()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">            ctx.beginPath();</span><br><span class="line">        &#125;,</span><br><span class="line">        close()&#123;</span><br><span class="line">            ctx.closePath();</span><br><span class="line">        &#125;,</span><br><span class="line">        strokeStyle(color)&#123;</span><br><span class="line">            ctx.strokeStyle = color;</span><br><span class="line">        &#125;,</span><br><span class="line">        moveTo(x,y)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(x,y);</span><br><span class="line">            ctx.moveTo(x,y);</span><br><span class="line">        &#125;,</span><br><span class="line">        lineTo(x,y)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(x,y);</span><br><span class="line">            ctx.lineTo(x,y);</span><br><span class="line">        &#125;,</span><br><span class="line">        stroke()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">            ctx.stroke();</span><br><span class="line">        &#125;,</span><br><span class="line">        fillStyle(color)&#123;</span><br><span class="line">            ctx.fillStyle = color;</span><br><span class="line">        &#125;,</span><br><span class="line">        fillRect(x,y,width,height)&#123;</span><br><span class="line">            ctx.fillRect(x,y,width,height);</span><br><span class="line">        &#125;,</span><br><span class="line">        strokeRect(x,y,width,height)&#123;</span><br><span class="line">            ctx.strokeRect(x,y,width,height);</span><br><span class="line">        &#125;,</span><br><span class="line">        arc(x,y,r,begin,end,dir)&#123;</span><br><span class="line">            ctx.arc(x,y,r,begin,end,dir);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">       <span class="comment">// 执行命令</span></span><br><span class="line">        execute(data)&#123;</span><br><span class="line">            data.forEach(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">let</span> &#123;command,param&#125; = item;</span><br><span class="line">                cmdList[command] &amp;&amp; cmdList[command](...param);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">       <span class="comment">// 添加新的命令</span></span><br><span class="line">        addCmd(key,value)&#123;</span><br><span class="line">            cmdList[key] = value;</span><br><span class="line">        &#125;,</span><br><span class="line">      	<span class="comment">// 移除命令</span></span><br><span class="line">        removeCmd(key)&#123;</span><br><span class="line">            <span class="keyword">delete</span> cmdList[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">CanvasCmd.execute([</span><br><span class="line">    &#123;<span class="attr">command</span>:<span class="string">"beginPath"</span>,<span class="attr">param</span>:[]&#125;,</span><br><span class="line">    &#123;<span class="attr">command</span>:<span class="string">"strokeStyle"</span>,<span class="attr">param</span>:[<span class="string">"red"</span>]&#125;,</span><br><span class="line">    <span class="comment">// other commands</span></span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<h4 id="7-责任链模式"><a href="#7-责任链模式" class="headerlink" title="7. 责任链模式"></a>7. 责任链模式</h4><p>责任链模式（Chain of responsibility）：为请求创建了一个接收者对象的链，对请求的发送者和接收者进行解耦。每个接收者都包含对另一个接收者的引用，当前接收者无法处理该请求，就会把请求交给下一个接收者。类似于原型链。</p>
<ul>
<li>场景</li>
</ul>
<p>情景：请假流程，小于3天，组长处理；大于3天小于5天，部门领导处理；大于5天总经理处理。</p>
<p>我们先按找平常的写法实现：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &lt;= <span class="number">3</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交组长处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>( value &lt;= <span class="number">5</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交部门领导处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>( value &gt; <span class="number">5</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交总经理处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">request(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<p>判断语句太多，改用责任链模式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将每个分支结构分离：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">director01</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &lt;= <span class="number">3</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交组长处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//移交给下一个处理人</span></span><br><span class="line">        director02(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">director02</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &lt;= <span class="number">5</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交部门领导处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//移交给下一个处理人</span></span><br><span class="line">        director03(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">director03</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &gt; <span class="number">5</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交总经理处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//只需要从第一个处理人开始</span></span><br><span class="line">director01(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<p>此时，耦合程度比上面的写法要好。但是每个处理人内部都必须强关联下一个处理人，不然就没法链式调用，耦合性还是很高，如果要添加一个处理人，那要改的地方就有该处理人上下两级，比较麻烦。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//职责链类：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chain</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.successor = [];</span><br><span class="line">        <span class="keyword">this</span>.length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    setSuccessor(...rest)&#123;</span><br><span class="line">        <span class="keyword">this</span>.successor = rest;</span><br><span class="line">        <span class="keyword">this</span>.length = rest.length;</span><br><span class="line">    &#125;</span><br><span class="line">    request(...rest)&#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span> <span class="title">getResult</span>(<span class="params">index</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>( index &gt;= <span class="keyword">this</span>.length )&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"无法处理。"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> result = <span class="keyword">this</span>.successor[index](...rest);</span><br><span class="line">            <span class="keyword">if</span>( result === <span class="string">"next"</span> )&#123;</span><br><span class="line">                index ++;</span><br><span class="line">                getResult.call(<span class="keyword">this</span>,index);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).call(<span class="keyword">this</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将每个分支结构分离：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">director01</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &lt;= <span class="number">3</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交组长处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//无须再强关联下一个处理函数</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"next"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">director02</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &lt;= <span class="number">5</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交部门领导处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"next"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">director03</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( value &gt; <span class="number">5</span> )&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"移交总经理处理。"</span>);</span><br><span class="line">        <span class="comment">//some code……</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现链</span></span><br><span class="line"><span class="keyword">let</span> request = <span class="keyword">new</span> Chain();</span><br><span class="line"><span class="comment">//设置处理队列</span></span><br><span class="line">request.setSuccessor(</span><br><span class="line">    director01,</span><br><span class="line">    director02,</span><br><span class="line">    director03,</span><br><span class="line">);</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">request.request(<span class="number">5</span>);</span><br><span class="line">request.request(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h4 id="8-中介者模式"><a href="#8-中介者模式" class="headerlink" title="8. 中介者模式"></a>8. 中介者模式</h4><p>中介者模式（Mediator）：提供了一个中介类，该类通常处理不同类之间的通信，使对象之间不再相互引用，降低他们之间的耦合，提高代码的可维护性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mediator = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> topics = &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> subscribe = <span class="function"><span class="keyword">function</span> (<span class="params">topic,fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!topics[topic]) topics[topic] = []</span><br><span class="line">    topics[topic].push(&#123;</span><br><span class="line">      ctx: <span class="keyword">this</span>,</span><br><span class="line">      cb:fn,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> publish = <span class="function"><span class="keyword">function</span> (<span class="params">topic</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> args</span><br><span class="line">    <span class="keyword">if</span>(!topics[topic])<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>)</span><br><span class="line">    topics[topic].forEach(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">let</span> subscription = item</span><br><span class="line">      subscription.cb.apply(item.ctx, args)</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    Publish: publish,</span><br><span class="line">    Subscribe: subscribe,</span><br><span class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      obj.publish = publish</span><br><span class="line">      obj.subscribe = subscribe</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<h4 id="9-解释器模式"><a href="#9-解释器模式" class="headerlink" title="9. 解释器模式"></a>9. 解释器模式</h4><p>解释器模式（Interpreter）：定义一种文法的表示，并定义一种解释器，通过这个解释器来解析对应文法的内容。</p>
<ul>
<li>场景  –  jQ提供的选择器</li>
</ul>
<p>原生js获取DOM元素的方式是有限的，jQ给我们提供了更为复杂的选择方式，比如：<code>$(&quot;#box p&quot;)</code>，这个参数规则就是jQ定义的一套选择元素的<em>文法</em>，而解析这个字符串，使之获取对应DOM元素的代码就是<em>解释器</em>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2019/08/01/组件间的通信—派发（dispatch)和广播（broadcast)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/组件间的通信—派发（dispatch)和广播（broadcast)/" itemprop="url">组件间的通信—派发（dispatch)和广播（broadcast)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-01T09:35:46+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>根据前文，provide/inject的使用具有局限性，对于父子组件的通信必须有其他的办法。</p>
<h3 id="on-和-emit"><a href="#on-和-emit" class="headerlink" title="$on 和 $emit"></a>$on 和 $emit</h3><p>在当前vue.js中，较常用的是$on 和 $emit。$emit主要用来触发事件，而$on用来监听被触发的事件。一般来说，子组件中使用$emit，父组件中使用$on。二者具体的用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"> &lt;button @click=&quot;handleClick&quot;&gt;</span><br><span class="line">   &lt;slot&gt;确定&lt;/slot&gt;</span><br><span class="line"> &lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export defalut&#123;</span><br><span class="line">        methods:&#123;</span><br><span class="line">            handleClick()&#123;</span><br><span class="line">                this.$emit(&apos;parent&apos;,&apos;123&apos;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;i-btn @parent = &apos;test&apos;/&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default&#123;</span><br><span class="line">        methods:&#123;</span><br><span class="line">            test(data)&#123;</span><br><span class="line">                console.log(data)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="dispatch-和-broadcast"><a href="#dispatch-和-broadcast" class="headerlink" title="dispatch 和 broadcast"></a>dispatch 和 broadcast</h3><p>上述写法一般只能用于一级的父子组件，那么对于多级，在1.x版本的vue.js中使用dispatch 和 broadcast。</p>
<ul>
<li><p>dispatch: 子组件向所有的父组件分发，从最近的向远处传播</p>
</li>
<li><p>broadcast: 父组件向子组件广播，从近到远</p>
</li>
</ul>
<p>他们传递的事件一旦被某组件通过$on监听到了，就会停止冒泡下去。可惜的是，在新版本vue.js中已经被废弃。</p>
<h3 id="自主实现dispatch-和-broadcast"><a href="#自主实现dispatch-和-broadcast" class="headerlink" title="自主实现dispatch 和 broadcast"></a>自主实现dispatch 和 broadcast</h3><p>预计功能：可以向父级组件或子组件，由近到远传播查询，直到找到对应的组件（更据唯一组件name是否一致），然后在改组件中进行监听。</p>
<p>需要传的参数：目标组件名，事件名，事件中用到的参数</p>
<p>具体代码实现如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// emmiter.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 父组件向子组件广播事件</span></span><br><span class="line"><span class="comment"> * @param cName 目标组件名</span></span><br><span class="line"><span class="comment"> * @param eName 事件名</span></span><br><span class="line"><span class="comment"> * @param eData 事件参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">broadCast</span>(<span class="params">cName,eName,eData</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> children = <span class="keyword">this</span>.$children</span><br><span class="line">  children.forEach(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> name = ele.$options.name</span><br><span class="line">    <span class="keyword">if</span>(name === cName)&#123;</span><br><span class="line">      ele.$emit.apply(ele,[eName].concat([eData]))</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">      broadCast.apply(ele,[cName,eName].concat([eData]))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 子组件向父组件分发事件</span></span><br><span class="line"><span class="comment"> * @param cName 目标组件名</span></span><br><span class="line"><span class="comment"> * @param eName 事件名</span></span><br><span class="line"><span class="comment"> * @param eData 事件参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">cName,eName,eData</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> parent = <span class="keyword">this</span>.$parent || <span class="keyword">this</span>.$root</span><br><span class="line">  <span class="keyword">let</span> name = parent.$options.name</span><br><span class="line">  <span class="keyword">while</span>(parent &amp;&amp; (!name || name!== cName))&#123;</span><br><span class="line">    parent = parent.$parent</span><br><span class="line">    <span class="keyword">if</span>(parent)&#123;</span><br><span class="line">      name = parent.$options.name</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(parent)&#123;</span><br><span class="line">    parent.$emit.apply(ele,[eName].concat([eData]))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  methods:&#123;</span><br><span class="line">    broadCast(cName,eName,eData)&#123;</span><br><span class="line">      broadCast.call(<span class="keyword">this</span>,cName,eName,eData)</span><br><span class="line">    &#125;,</span><br><span class="line">    dispatch(cName,eName,eData)&#123;</span><br><span class="line">      dispatch.call(<span class="keyword">this</span>,cName,eName,eData)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// c-a.vue  </span><br><span class="line">&lt;tempalte&gt;</span><br><span class="line">  &lt;button @click=&apos;handleClick&apos;&gt;确认&lt;/button&gt;</span><br><span class="line">&lt;/tempalte&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"> import Emmiter from &apos;../mixins/emmiter.js&apos;</span><br><span class="line"> export default&#123;</span><br><span class="line">   mixins: [Emmiter]</span><br><span class="line">   name: &apos;c-a&apos;,</span><br><span class="line">   methods:&#123;</span><br><span class="line">     handleClick()&#123;</span><br><span class="line">       this.broadCast(&apos;c-b&apos;,&apos;test&apos;,&apos;当前组件的数据传给子组件&apos;)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// c-b.vue  </span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;i-btn @test=&quot;out&quot;/&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"> import &apos;iBtn&apos; from &apos;../c-a&apos;</span><br><span class="line"> export default&#123;</span><br><span class="line">   components:&#123;iBtn&#125;,</span><br><span class="line">   name:&apos;c-b&apos;,</span><br><span class="line">  //  created()&#123;</span><br><span class="line">  //    this.$on(&apos;test&apos;,this.out)</span><br><span class="line">  //  &#125;,</span><br><span class="line">   methods:&#123;</span><br><span class="line">     out(data)&#123;</span><br><span class="line">       console.log(data)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2019/08/01/组件间的通信/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/组件间的通信/" itemprop="url">组件间的通信-开始</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-01T09:35:46+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>了解一个组件，最基础的三个部分： prop, slot 以及 event。</p>
<ul>
<li><p>prop</p>
<p>prop定义了该组件有哪些属性是可配置的，对于prop最好使用对象的写法，这样就可以对传入的prop进行校验。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">props:&#123;</span><br><span class="line">    size:&#123;</span><br><span class="line">        validator(value)&#123;<span class="keyword">return</span> test(value)&#125;,</span><br><span class="line">        <span class="keyword">default</span>: <span class="string">"default"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    page: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        defalut: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>slot</p>
<p>插槽，主要用来对组件进行扩展，可以是文字，也可以是html或者其他组件。</p>
<template><br>  <button :class="'i-button-size' + size" :disabled="disabled"><br>    <slot></slot><br>  </button><br></template>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i-button</span>&gt;</span>按钮 1<span class="tag">&lt;/<span class="name">i-button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">i-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">strong</span>&gt;</span>按钮 2<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">i-button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上是单独一个插槽，也可以使用多个插槽。插槽也可以是命名的插槽。</p>
<slot name="icon"></slot><br><slot>默认显示内容</slot>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i-icon</span> <span class="attr">slot</span>=<span class="string">"icon"</span> <span class="attr">type</span>=<span class="string">"checkmark"</span>&gt;</span><span class="tag">&lt;/<span class="name">i-icon</span>&gt;</span></span><br><span class="line">  按钮 1</span><br><span class="line"><span class="tag">&lt;/<span class="name">i-button</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>event</p>
<p>对于自定义的事件，会使用到$emit, 具体的代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"> &lt;button @click=&quot;test&quot;&gt;BUTTON&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default&#123;</span><br><span class="line">        methods:&#123;</span><br><span class="line">            test(event)&#123;</span><br><span class="line">                this.$emit(&apos;f-click&apos;,event)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i-btn</span> @<span class="attr">f-click</span>=<span class="string">"tan"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>tips: 对于一些可能和原生事件混淆的自定义事件（如click），可以通过@click.native来区别</p>
</li>
</ul>
<p>接着讲进入本系列的主题——组件间的通信。</p>
<p>组件间的关系可以分为父子关系，兄弟关系。针对父子关系，又可以包含多代父子。组件通信方式多凭借$parent,$children,ref等。</p>
<p>父子组件通信可以通过$parent,$children,但是这只能针对于一代的父子；如果相隔多代，就不可行了。</p>
<p>使用ref的简单例子如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;component-a ref=&quot;comA&quot;&gt;&lt;/component-a&gt;</span><br><span class="line">...</span><br><span class="line">this.$refs.comA</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>所以在实际组件的开发中，我们会考虑使用别的方法。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2019/08/01/变量的解构赋值/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/变量的解构赋值/" itemprop="url">变量的解构赋值</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-01T09:35:46+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="数组解构赋值"><a href="#数组解构赋值" class="headerlink" title="数组解构赋值"></a>数组解构赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a,b,c] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> [x, , y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> [x, y, ...z] = [<span class="string">'a'</span>]; <span class="comment">// x=a,y=undefined,z=[]</span></span><br><span class="line"><span class="keyword">let</span> [x, y = <span class="string">'b'</span>] = [<span class="string">'a'</span>, <span class="literal">undefined</span>]; <span class="comment">// x='a', y='b'</span></span><br><span class="line"><span class="keyword">let</span> [x, y, z] = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]); <span class="comment">// x='a'</span></span><br></pre></td></tr></table></figure>
<h3 id="对象解构赋值"><a href="#对象解构赋值" class="headerlink" title="对象解构赋值"></a>对象解构赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; foo, bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">'aaa'</span>, <span class="attr">bar</span>: <span class="string">'bbb'</span> &#125;;  <span class="comment">// foo-&gt;aaa,bar-&gt;bbb</span></span><br><span class="line"><span class="keyword">let</span> &#123; baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">'aaa'</span>, <span class="attr">bar</span>: <span class="string">'bbb'</span> &#125;; <span class="comment">// baz-&gt;undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; log &#125; = <span class="built_in">console</span>;</span><br><span class="line">log(<span class="string">'hello'</span>) <span class="comment">// hello</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">foo</span>: baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">'aaa'</span>, <span class="attr">bar</span>: <span class="string">'bbb'</span> &#125;; <span class="comment">// baz-&gt;foo-&gt;aaa,foo-&gt;undefined</span></span><br></pre></td></tr></table></figure>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误的写法</span></span><br><span class="line"><span class="keyword">let</span> x;</span><br><span class="line">&#123;x&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// SyntaxError: syntax error</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确的写法</span></span><br><span class="line"><span class="keyword">let</span> x;</span><br><span class="line">(&#123;x&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="字符串解构赋值"><a href="#字符串解构赋值" class="headerlink" title="字符串解构赋值"></a>字符串解构赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">'hello'</span>; <span class="comment">// a-&gt;'h',...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">length</span> : len&#125; = <span class="string">'hello'</span>; <span class="comment">//len:5</span></span><br></pre></td></tr></table></figure>
<h3 id="数字和布尔值的解构赋值"><a href="#数字和布尔值的解构赋值" class="headerlink" title="数字和布尔值的解构赋值"></a>数字和布尔值的解构赋值</h3><p>解构赋值时，如果等号右边是数值和布尔值，则会先转为对象</p>
<h3 id="函数参数解构赋值"><a href="#函数参数解构赋值" class="headerlink" title="函数参数解构赋值"></a>函数参数解构赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">[x, y]</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line">add([<span class="number">1</span>, <span class="number">2</span>]); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]].map(<span class="function">(<span class="params">[a, b]</span>) =&gt;</span> a + b);</span><br><span class="line"><span class="comment">// [ 3, 7 ]</span></span><br></pre></td></tr></table></figure>
<h3 id="圆括号-问题"><a href="#圆括号-问题" class="headerlink" title="圆括号()问题"></a>圆括号()问题</h3><p>ES6 的规则是，只要有可能导致解构的歧义，就不得使用圆括号。建议只要有可能，就不要在模式中放置圆括号。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2019/08/01/组件开发流程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/组件开发流程/" itemprop="url">基础组件开发二三事</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-01T09:35:46+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Keys"><a href="#Keys" class="headerlink" title="Keys"></a>Keys</h3><h4 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h4> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vue create my-project</span><br><span class="line">yarn add vue-router // 安装router</span><br><span class="line">yarn add async-validator // 常用的校验库</span><br></pre></td></tr></table></figure>
<h4 id="项目结构调整"><a href="#项目结构调整" class="headerlink" title="项目结构调整"></a>项目结构调整</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">++ src</span><br><span class="line">++++ assets --静态资源，如图片等</span><br><span class="line">++++ components </span><br><span class="line">++++++form   </span><br><span class="line">++++++++form.vue</span><br><span class="line">++++++++form-item.vue</span><br><span class="line">++++++input</span><br><span class="line">++++++++input.vue</span><br><span class="line">++++ mixins --用来混入</span><br><span class="line">++++++emmiter.js --实现dispatch和broadcast</span><br><span class="line">++++ views</span><br><span class="line">++++++Form.vue</span><br><span class="line">++++ main.js</span><br><span class="line">++++ App.vue</span><br><span class="line">++++ router.js --路由</span><br></pre></td></tr></table></figure>
<h4 id="router-js"><a href="#router-js" class="headerlink" title="router.js"></a>router.js</h4><p>推荐使用组件按需加载的方式，也就是懒加载，可以节省页面初始化的时间。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      name: <span class="string">'home'</span>,</span><br><span class="line">      component: Home</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/form'</span>,</span><br><span class="line">      name: <span class="string">'form'</span>,</span><br><span class="line">      component: <span class="function"><span class="params">()</span>=&gt;</span><span class="keyword">import</span>(<span class="string">'./views/Form.vue'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="mixin写法"><a href="#mixin写法" class="headerlink" title="mixin写法"></a>mixin写法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> test <span class="keyword">from</span> <span class="string">'../../test.js'</span> <span class="comment">//混入make方法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    mixins: [test],</span><br><span class="line">    methods:&#123;</span><br><span class="line">        <span class="keyword">this</span>.make()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="父子组件通信"><a href="#父子组件通信" class="headerlink" title="父子组件通信"></a>父子组件通信</h4><ul>
<li>通过自定义的dispatch和broadcast传递事件</li>
<li>在组件中通过$on监听被触发的事件</li>
<li>组件渲染顺序是从内到外的，子组件的mounted在父组件的mounted之前，在父组件的created之后。所以，应该在父组件的created里面监听事件。</li>
<li>如果只是单纯的传递数据，状态等，可以结合实际，考虑使用provide/inject（可以给所有子组件通过注入的方式使用，类似vux) 和 props(一级一级的传)</li>
</ul>
<h4 id="常用易混淆的JS方法"><a href="#常用易混淆的JS方法" class="headerlink" title="常用易混淆的JS方法"></a>常用易混淆的JS方法</h4><ul>
<li><p>filter forEach every</p>
<ul>
<li>every()是对数组中的每一项运行给定函数，如果该函数对每一项都返回true，则返回true。</li>
<li>some()是对数组中的每一项运行给定函数，如果该函数对任一项返回true，则返回true。</li>
<li>filter()是对数组中的每一项运行给定函数，返回该函数会返回true的项所组成的数组。</li>
<li>forEach() 是多数组中的每一项运行给定函数，这个方法没有返回值。它只是对数组中的每一项运行传入的函数，没有返回值。本质上与使用for循环迭代数组一样。</li>
</ul>
</li>
<li><p>apply call bind</p>
<p>call 和 apply 都是为了改变某个函数运行时的上下文（context）而存在的，换句话说，就是为了改变函数体内部 this 的指向。</p>
<p><strong>立即执行</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func.call(<span class="keyword">this</span>, arg1, arg2);</span><br><span class="line">func.apply(<span class="keyword">this</span>, [arg1, arg2]);</span><br></pre></td></tr></table></figure>
<p><code>bind()</code>最简单的用法是创建一个函数，使这个函数不论怎么调用都有同样的this值。</p>
<p><strong>不立即执行，只是创建一个函数</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> boundGetNum = getNum.bind(mymodule);</span><br><span class="line">boundGetNum();</span><br></pre></td></tr></table></figure>
</li>
<li><p>AsyncValidator的使用</p>
</li>
</ul>
<h4 id="async-validator"><a href="#async-validator" class="headerlink" title="async-validator"></a>async-validator</h4><p>异步验证，需要传入验证的规则和需要验证的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 验证的规则</span></span><br><span class="line">ruleValidate: &#123;</span><br><span class="line">  name: [</span><br><span class="line">     &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"用户名不能为空"</span>, <span class="attr">trigger</span>: <span class="string">"blur"</span> &#125;,</span><br><span class="line">     &#123; <span class="attr">type</span>:<span class="string">'email'</span>, <span class="attr">message</span>:<span class="string">'必须为邮箱格式'</span>, <span class="attr">trigger</span>: <span class="string">"blur"</span> &#125;</span><br><span class="line">    ],      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要验证的数据格式</span></span><br><span class="line">&#123;</span><br><span class="line">    a: xxx,</span><br><span class="line">    b: xxx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 验证的通用代码</span></span><br><span class="line"><span class="keyword">let</span> descriptor = &#123;&#125;;</span><br><span class="line">descriptor[<span class="keyword">this</span>.prop] = rule; <span class="comment">// descriptor['name']</span></span><br><span class="line"><span class="keyword">const</span> validator = <span class="keyword">new</span> AsyncValidator(descriptor);  <span class="comment">// 封装验证器</span></span><br><span class="line"><span class="keyword">let</span> model = &#123;&#125;;</span><br><span class="line">model[<span class="keyword">this</span>.prop] = <span class="keyword">this</span>.filedValue; <span class="comment">// 封装验证的数据</span></span><br><span class="line">validator.validate(model, &#123; <span class="attr">firstFields</span>: <span class="literal">true</span> &#125;, errors =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.validateState = !errors ? <span class="string">'success'</span> : <span class="string">'error'</span>;</span><br><span class="line">      <span class="keyword">this</span>.validateMessage = errors ? errors[<span class="number">0</span>].message : <span class="string">''</span>;</span><br><span class="line">      callback(<span class="keyword">this</span>.validateMessage); <span class="comment">// callback是回调函数</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="调用子组件的方法"><a href="#调用子组件的方法" class="headerlink" title="调用子组件的方法"></a>调用子组件的方法</h4><p>给子组件一个ref = ‘test’</p>
<p>this.$refs.test.方法()</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2019/08/01/更快加载HTML页面的一些策略/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/更快加载HTML页面的一些策略/" itemprop="url">如何更快加载HTML页面</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-01T09:35:46+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="减少页面的大小"><a href="#减少页面的大小" class="headerlink" title="减少页面的大小"></a>减少页面的大小</h3><p>排除不必要的空格，注释，内嵌脚本等。</p>
<h3 id="最小化文件数量"><a href="#最小化文件数量" class="headerlink" title="最小化文件数量"></a>最小化文件数量</h3><p>减少文件引用的数量，也就是降低http请求次数。</p>
<h3 id="减少域名查找"><a href="#减少域名查找" class="headerlink" title="减少域名查找"></a>减少域名查找</h3><p>每个独立的域名都会耗费DNS查找时间，所以在页面中尽量少的使用来自不同域名的地址</p>
<h3 id="缓存重用的内容"><a href="#缓存重用的内容" class="headerlink" title="缓存重用的内容"></a>缓存重用的内容</h3><p>确保会被多次使用的内容被缓存，下次加载减少渲染时间</p>
<h3 id="高效排列页面组件"><a href="#高效排列页面组件" class="headerlink" title="高效排列页面组件"></a>高效排列页面组件</h3><p>页面最初显示时，会先下载页面内容和所需的js以及css。而页面中具有动态特性的资源需要在页面完全加载之后，才会被使用。所以，最好在初始化时关闭动态特性（disable dynamic features ），等页面加载完后再打开它。这样JavaScript就会在网页内容之后才加载，有助于提升页面加载的整体表现。</p>
<h3 id="减少内联脚本"><a href="#减少内联脚本" class="headerlink" title="减少内联脚本"></a>减少内联脚本</h3><h3 id="使用CSS和合法标志"><a href="#使用CSS和合法标志" class="headerlink" title="使用CSS和合法标志"></a>使用CSS和合法标志</h3><h3 id="给内容分块"><a href="#给内容分块" class="headerlink" title="给内容分块"></a>给内容分块</h3><h3 id="指定图像和表格的大小"><a href="#指定图像和表格的大小" class="headerlink" title="指定图像和表格的大小"></a>指定图像和表格的大小</h3><h3 id="合理选择user-agent"><a href="#合理选择user-agent" class="headerlink" title="合理选择user-agent"></a>合理选择user-agent</h3><h3 id="尽量使用async和defer"><a href="#尽量使用async和defer" class="headerlink" title="尽量使用async和defer"></a>尽量使用async和defer</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">没有 defer 或 async，浏览器会立即加载并执行指定的脚本，不等待后续载入的文档元素，读到就加载并执行 </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">加载和渲染后续文档元素的过程将和 script.js 的加载与执行并行进行（异步）</span></span><br><span class="line"><span class="comment">async的执行，并不会按着script在页面中的顺序来执行，而是谁先加载完谁执行。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">有defer，加载后续文档元素的过程将和 script.js 的加载并行进行（异步），但是 script.js 的执行要在所有元素解析完成之后，DOMContentLoaded 事件触发之前完成。</span></span><br><span class="line"><span class="comment">如果有多个设置了defer的script标签存在，则会按照顺序执行所有的script；</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">"myscript.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="https://www.cnblogs.com/jiasm/p/7683930.html" target="_blank" rel="noopener">更多相关见本链接</a></p>
<h3 id="页面结构示例"><a href="#页面结构示例" class="headerlink" title="页面结构示例"></a>页面结构示例</h3><p>HEAD<br>     LINK …<br>    CSS 文件用来修饰页面外观。在调试维护中把不相关的 CSS 拆分在不同文件中，且尽量减少文件的数量可以提高性能。<br>    SCRIPT …<br>    JavaScript 文件用来实现页面加载时的一些功能，但不是所有的 DHTML 在页面加载后才能运行。<br>在调试维护中把不相关的 JavaScript 拆分在不同文件中，且尽量减少文件的数量可以提高性能。<br>· BODY<br>  在一块组件（tables / divs）中用户可见的页面内容，不必等页面完全加载也能显出来的。<br>    SCRIPT …<br>        被用来支持动态页面（DHTML）展示的脚本。</p>
<p>DHTML 脚本通常在页面完全加载或者所有必要的对象（objects）已初始化完毕之后才能运行。没有必要在页面内容之前加载这些脚本，这只会拖慢页面加载和初始化的体验。<br>在调试维护中把不相关的 script 拆分在不同文件中，且尽量减少文件的数量可以提高性能。<br>如有图像用到了反转效果，你应该在页面内容下载完后预加载这些图像。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://flybids.github.io/2019/08/01/组件间的通信-projectinject/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Huang Gang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Redo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/组件间的通信-projectinject/" itemprop="url">组件间的通信-provide/inject</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-01T09:35:46+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在实际开发中，对于比较复杂的组件间的通信，我们一般会引入vux等第三方库。但是在单独开发组件，不考虑引入第三方资源，如开发组件库时，我们可以使用vue内置的provide和inject。</p>
<p>provide相当于主动提供，而inject是依赖注入。</p>
<p>如何理解provide和inject?直接看代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父级组件提供 'foo' 给所有子组件</span></span><br><span class="line"><span class="keyword">var</span> Provider = &#123;</span><br><span class="line">  provide: &#123;</span><br><span class="line">    foo: <span class="string">'bar'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件注入 'foo'</span></span><br><span class="line"><span class="keyword">var</span> Child = &#123;</span><br><span class="line">  inject: [<span class="string">'foo'</span>],</span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.foo) <span class="comment">// =&gt; "bar"</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><i style="color:'red'"><code>provide</code> 和 <code>inject</code> 主要为高阶插件/组件库提供用例。并不推荐直接用于应用程序代码中</i></p>
<p>他们的局限在于，多用于子组件获取父组件的状态，对于父子组件的通信就不适用。对此，见下文。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Huang Gang</p>
              <p class="site-description motion-element" itemprop="description">flybid's blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Huang Gang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
